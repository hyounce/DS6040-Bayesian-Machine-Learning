# Homework 2 - Hilde Younce

```{r}
# install.packages("rstan", repos = c('https://stan-dev.r-universe.dev', getOption("repos")))
library(ggplot2)
library(rstan)
```

## Problem 1:

```{r}
# Get data 
wine_train <- read.csv('whitewine-training-ds6040.csv')
```

```{r}
# Density plot 1: residual.sugar
ggplot(wine_train, aes(x=residual.sugar)) + geom_density(fill = "lightblue")
```

The density plot for residual.sugar does not look very normally distributed. There is a higher density around -1 that declines and then zeros out at around 2.5, and is skewed towards the right. 

```{r}
# Density plot 2: total.sulfur.dioxide
ggplot(wine_train, aes(x=total.sulfur.dioxide)) + geom_density(fill = "lightblue")
```

The density for total.sulfur.dioxide looks much more normal than the density plot for residual.sugar. There looks to be a mean value around -0.5, with a slight skew to the right. 

**Part 1:**

```{r}
# Function to calculate posterior (sample mean, sample variance, mu0, tau, n)
normal_posterior <- function(n, sigma, mu, mu0, tau){
  post_var <- 1 / (1 / sigma + 1 / tau)
  post_mean <- (mu / sigma + mu0 / tau) * post_var
  return (c(post_var, post_mean))
}
```


```{r}
# Residual sugar - uninformative prior
var_sugar <- var(wine_train$residual.sugar)
n = nrow(wine_train)
mu0 = 0
tau = 1000 # high variance
mu = rnorm(n, mu0, tau) # conjugate prior
post <- normal_posterior(n, var_sugar, mu, mu0, tau)
```

```{r}
# Residual sugar - informative prior

```

```{r}
# Total Sulfur Dioxide - uninformative prior
var_sulfur <- var(wine_train$total.sulfur.dioxide)
```

```{r}
# Total Sulfur Dioxide - informative prior
```

